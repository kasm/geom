<html>
  <head>
    <style>
      #cont {
        display: flex;
      }
      canvas {
 
        border: 1px solid red;
      }
      #dashboard > div {
        margin: 5px;
      }
      textarea {
        contenteditable: true;
        border: 1px solid black;
        background-color: antiquewhite;
        width: 450px;
        height: 550px;
      }
    </style>
  </head>
<body>
  <div id="cont">
    <div id="canv"><canvas>
    </canvas></div>
    <div id="dashboard">
      <div>
        <textarea> 
        </textarea>
      </div>
      <div>
        <button id="apply">apply</button>
      </div>
        
      
    </div>
  </div>

</body>
<script src = "geom_core.js"></script>
<script>
  
  let width = 600
  let height = 600
  let canvas = document.querySelector('canvas')
  let div = document.querySelector('div')
  canvas.width=width
  canvas.height = height
  let ctx = canvas.getContext('2d')
  function conv(p) {
    return [
      p[0] + width / 2,
      height / 2 - p[1] 
    ]
  }
  function drawAxis() {
    ds([[-width, 0], [width, 0]])
    ds([[0, -height], [0, height]])
  }
  drawAxis()
  function dp(p, color) {
    console.log(p)
    let r = 3
    let c = color ?? 'black'
    ctx.beginPath()
    ctx.fillStyle = c
    ctx.moveTo(conv(p[0]), (p[1]))
    ctx.lineTo(conv(p[0]+5), p[1])
    console.log('dp: ', conv(p))
    ctx.arc(conv(p)[0], conv(p)[1], r, 0, Math.PI*2)
    ctx.stroke()
    ctx.fill()
    // ctx.endPath()
  }
  function li(li, color) {
    let d = 5555
    let p0 = [
      li
    ]
  }
  function ds(seg1, color) {
    ctx.beginPath()
    ctx.moveTo(conv(seg1[0])[0], conv(seg1[0])[1])
    ctx.lineTo(conv(seg1[1])[0], conv(seg1[1])[1])
    ctx.stroke()
  }
</script>



<script>
  let gc = GeomCore();
  let ta = document.querySelector('textarea')
  ta.innerHTML='kjkjk'
  // let p0 = [-100, 100]
  // let p1 = [-200, 100]
  // let line01 = []
  // ds([p0, p1])
  // line01 = gc.line_point_point(line01, p0, p1)
  // console.log('line 01', line01)
  // dp(p0, 'green')
  // dp(p1, 'red')


  let p = `
  ctx.clearRect(0, 0, canvas.width, canvas.height)
  drawAxis()

  let p0 = [-100, 100]
  let p1 = [-200, 100]
  let p21 = [-250, 152]
  let line01 = []
  let line21 = []
  ds([p0, p1])
  ds([p0, p21])
  line01 = gc.line_point_point(line01, p0, p1)
  line21 = gc.line_point_point(line21, p0, p21)
  let p22 = []
  p22 = gc.point_per_point_line(p22, p1, line21)
  console.log('line 01', line01)
  dp(p0, 'green')
  dp(p1, 'red')
  dp(p21, 'red')
  dp(p22, 'blue')

  `
  ta.value=p

  eval(p)
  document.getElementById('apply').addEventListener('click', () => {
    let t = ta.value
    console.log(t)
    eval(t)
  })
</script>

</html>
